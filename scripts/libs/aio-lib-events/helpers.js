const querystring=require("querystring"),httplinkheader=require("http-link-header"),url=require("url");function reduceError(e={}){const r=e;return r.status&&r.statusText&&r.url?`${r.status} - ${r.statusText} (${r.url})`:e}function appendQueryParams(e,r){let t=e;if(r&&0!==Object.keys(r).length){const n=Object.entries(r).filter((([e,r])=>!(null==r)));if(0===Object.keys(n).length)return t;t+=`${e.indexOf("?")>=0?"&":"?"}${querystring.stringify(Object.fromEntries(n))}`}return t}function parseLinkHeader(e,r){const t={},n=httplinkheader.parse(r);for(const r of n.refs)t[r.rel]=new url.URL(r.uri,e).href;return t}function getProperPayload(e){return isBase64Encoded(e)?Buffer.from(e,"base64").toString("utf-8"):e}function isBase64Encoded(e){return Buffer.from(e,"base64").toString("base64")===e}function genErrorResponse(e,r){return{error:{statusCode:e,body:r,headers:{"Content-Type":"application/json"}}}}const exportFunctions={reduceError,appendQueryParams,parseLinkHeader,getProperPayload,genErrorResponse};module.exports={exportFunctions};